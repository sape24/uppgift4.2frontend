let e=document.getElementById("open-menu"),t=document.getElementById("close-menu");function o(){let e=document.getElementById("mobilemenu");"none"===window.getComputedStyle(e).display?e.style.display="block":e.style.display="none"}async function n(){let e={username:document.getElementById("username").value,password:document.getElementById("password").value};if(!e.username||!e.password){document.getElementById("errormessage").textContent="Du måste fylla i alla fält!";return}try{let t=await fetch("https://uppgift4-1backend.onrender.com/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Nätverksproblem - felaktigt svar från servern");let o=await t.json();console.log(o),window.location.href="index.html"}catch(e){console.error("Det uppstod ett fel:",e.message)}}async function r(){let e={username:document.getElementById("username").value,password:document.getElementById("password").value};if(!e.username||!e.password){document.getElementById("errormessage").textContent="Du måste fylla i alla fält!";return}try{let t=await fetch("https://uppgift4-1backend.onrender.com/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Nätverksproblem - felaktigt svar från servern");let o=await t.json();localStorage.setItem("token",o.response.token),console.log("token sparad",o.response.token),console.log(o),await a()?window.location.href="protected.html":(console.error("Åtkomst nekad: token ogiltig eller saknas"),document.getElementById("errormessage").textContent="Inloggning misslyckades var god försök igen")}catch(e){console.error("Det uppstod ett fel:",e.message)}}async function a(){let e=localStorage.getItem("token");if(!e)return console.error("ingen token hittades"),!1;try{let t=await fetch("https://uppgift4-1backend.onrender.com/api/protected",{method:"GET",headers:{Authorization:"Bearer "+e}});if(!t.ok)return!1;let o=await t.json();return console.log(o),!0}catch(e){return console.error("Det uppstod ett fel:",e.message),!1}}e.addEventListener("click",o),t.addEventListener("click",o);const l=document.querySelector(".loginform");l&&l.addEventListener("submit",e=>{e.preventDefault(),r()});const s=document.querySelector(".registerform");async function d(){let e=localStorage.getItem("token");e||(console.error("Åtkomst nekad: Token ogiltig eller saknas"),window.location.href="index.html");try{let t=await fetch("https://uppgift4-1backend.onrender.com/api/protected",{method:"GET",headers:{Authorization:"Bearer "+e}});if(!t.ok){console.error("Fel inträffat token ogiltig eller åtkomst nekad"),localStorage.removeItem("token"),window.location.href="index.html";return}let o=await t.json();console.log(o);let n=document.getElementById("protectedData"),r=document.createElement("h2");r.textContent="Lyckad inloggning! Välkommen";let a=document.createElement("p");a.textContent=o.message,n.appendChild(r),n.appendChild(a)}catch(e){console.error("Det uppstod ett fel:",e.message)}}s&&s.addEventListener("submit",e=>{e.preventDefault(),n()}),location.pathname.includes("protected.html")&&document.addEventListener("DOMContentLoaded",d);
//# sourceMappingURL=uppgift4.2frontend.2a19e3c4.js.map
