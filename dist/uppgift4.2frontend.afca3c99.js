let e=document.getElementById("open-menu"),t=document.getElementById("close-menu");function o(){let e=document.getElementById("mobilemenu");"none"===window.getComputedStyle(e).display?e.style.display="block":e.style.display="none"}async function n(){let e={username:document.getElementById("username").value,password:document.getElementById("password").value};if(!e.username||!e.password){document.getElementById("errormessage").textContent="Du måste fylla i alla fält!";return}try{let t=await fetch("https://uppgift4-1backend.onrender.com/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Nätverksproblem - felaktigt svar från servern");let o=await t.json();console.log(o),window.location.href="index.html"}catch(e){console.error("Det uppstod ett fel:",e.message)}}async function r(){let e={username:document.getElementById("username").value,password:document.getElementById("password").value};if(!e.username||!e.password){document.getElementById("errormessage").textContent="Du måste fylla i alla fält!";return}try{let t=await fetch("https://uppgift4-1backend.onrender.com/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Nätverksproblem - felaktigt svar från servern");let o=await t.json();localStorage.setItem("token",o.response.token),console.log("token sparad",o.response.token),console.log(o),await s()?window.location.href="protected.html":(console.error("Åtkomst nekad: token ogiltig eller saknas"),document.getElementById("errormessage").textContent="Inloggning misslyckades var god försök igen")}catch(e){console.error("Det uppstod ett fel:",e.message)}}async function s(){let e=localStorage.getItem("token");if(!e)return console.error("ingen token hittades"),!1;try{let t=await fetch("https://uppgift4-1backend.onrender.com/api/protected",{method:"GET",headers:{Authorization:"Bearer "+e}});if(!t.ok)return!1;let o=await t.json();return console.log(o),!0}catch(e){return console.error("Det uppstod ett fel:",e.message),!1}}e.addEventListener("click",o),t.addEventListener("click",o);const a=document.querySelector(".loginform");a&&a.addEventListener("submit",e=>{e.preventDefault(),r()});const l=document.querySelector(".registerform");l&&l.addEventListener("submit",e=>{e.preventDefault(),n()});
//# sourceMappingURL=uppgift4.2frontend.afca3c99.js.map
